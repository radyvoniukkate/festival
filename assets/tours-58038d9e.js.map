{"version":3,"file":"tours-58038d9e.js","sources":["../../src/js/tours.js"],"sourcesContent":["import { createParticipant, createTask } from '../api/festival.js';\n\nconst BASE_URL = 'http://localhost:8080/festival';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  let isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';\n  let currentParticipants = []; // Store currently displayed participants\n  const logoutBtn = document.getElementById('logoutBtn');\n  const loginLink = document.getElementById('loginLink');\n\n  const updateButtonVisibility = () => {\n    document\n      .querySelectorAll('.editBtn, .deleteBtn, #addBtn')\n      .forEach(button => {\n        button.style.display = isAuthenticated ? 'inline-block' : 'none';\n      });\n  };\n\n  if (loginLink && logoutBtn) {\n    if (isAuthenticated) {\n      loginLink.style.display = 'none';\n      logoutBtn.style.display = 'block';\n    }\n\n    logoutBtn.addEventListener('click', function () {\n      localStorage.removeItem('isAuthenticated');\n      isAuthenticated = false;\n      updateButtonVisibility();\n      window.location.href = './index.html';\n    });\n  }\n\n  const modal = document.getElementById('myModal');\n  const btn = document.getElementById('addBtn');\n  const span = document.getElementsByClassName('close')[0];\n  const form = document.getElementById('createForm');\n  const tableBody = document.querySelector('#participantsTable tbody');\n  const sortBtnId = document.getElementById('sortBtnId');\n  const sortBtnScore = document.getElementById('sortBtn');\n  const sortBtnDate = document.getElementById('sortBtnDate');\n  const tour1Btn = document.getElementById('tour1');\n  const tour2Btn = document.getElementById('tour2');\n  const tour3Btn = document.getElementById('tour3');\n  let editMode = false;\n\n  btn.onclick = function () {\n    console.log('Open modal for adding participant');\n    editMode = false;\n    form.reset();\n    document.getElementById('participantId').value = '';\n    modal.style.display = 'block';\n  };\n\n  span.onclick = function () {\n    console.log('Close modal');\n    modal.style.display = 'none';\n  };\n\n  window.onclick = function (event) {\n    if (event.target == modal) {\n      console.log('Close modal on outside click');\n      modal.style.display = 'none';\n    }\n  };\n\n  const loadParticipants = () => {\n    const participants = JSON.parse(localStorage.getItem('participants')) || [];\n    currentParticipants = participants;\n    reloadTable(participants);\n  };\n\n  const addRowToTable = participant => {\n    console.log('Adding row for participant:', participant);\n    const row = document.createElement('tr');\n    row.setAttribute('data-id', participant.id);\n    row.innerHTML = `\n            <td>${participant.id}</td>\n            <td>${participant.name}</td>\n            <td>${participant.email}</td>\n            <td>${participant.task}</td>\n            <td>${participant.averageScore}</td>\n            <td>${participant.datetime}</td>\n            <td class=\"action-buttons\">\n                <button class=\"editBtn\" style=\"display: ${\n                  isAuthenticated ? 'inline-block' : 'none'\n                }\">Редагувати</button>\n                <button class=\"deleteBtn\" style=\"display: ${\n                  isAuthenticated ? 'inline-block' : 'none'\n                }\">Видалити</button>\n            </td>\n        `;\n    tableBody.appendChild(row);\n\n    row.querySelector('.editBtn').addEventListener('click', function () {\n      if (isAuthenticated) {\n        console.log('Edit participant:', participant);\n        editMode = true;\n        openEditModal(participant);\n      }\n    });\n\n    row.querySelector('.deleteBtn').addEventListener('click', function () {\n      if (isAuthenticated) {\n        console.log('Delete participant:', participant.id);\n        deleteParticipant(participant.id);\n      }\n    });\n  };\n\n  const getNextId = () => {\n    const participants = JSON.parse(localStorage.getItem('participants')) || [];\n    return participants.length\n      ? participants[participants.length - 1].id + 1\n      : 1;\n  };\n\n  const saveParticipant = participant => {\n    console.log('Save participant:', participant);\n    let participants = JSON.parse(localStorage.getItem('participants')) || [];\n    if (editMode) {\n      participants = participants.map(p =>\n        p.id === participant.id ? participant : p\n      );\n    } else {\n      participant.id = getNextId();\n      participants.push(participant);\n    }\n    localStorage.setItem('participants', JSON.stringify(participants));\n  };\n\n  const deleteParticipant = id => {\n    console.log('Delete participant with id:', id);\n    let participants = JSON.parse(localStorage.getItem('participants')) || [];\n    participants = participants.filter(p => p.id !== id);\n    localStorage.setItem('participants', JSON.stringify(participants));\n    document.querySelector(`tr[data-id=\"${id}\"]`).remove();\n  };\n\n  const openEditModal = participant => {\n    console.log('Open edit modal for participant:', participant);\n    document.getElementById('participantId').value = participant.id;\n    document.getElementById('name').value = participant.name;\n    document.getElementById('email').value = participant.email;\n    document.getElementById('task').value = participant.task;\n    const scores = participant.scores || [0, 0, 0, 0];\n    document.getElementById('score1').value = scores[0];\n    document.getElementById('score2').value = scores[1];\n    document.getElementById('score3').value = scores[2];\n    document.getElementById('score4').value = scores[3];\n    document.getElementById('datetime').value = participant.datetime;\n    modal.style.display = 'block';\n  };\n\n  form.onsubmit = function (event) {\n    event.preventDefault();\n    console.log('Form submitted');\n\n    const id = parseInt(form.participantId.value, 10) || null;\n    const score1 = parseFloat(form.score1.value);\n    const score2 = parseFloat(form.score2.value);\n    const score3 = parseFloat(form.score3.value);\n    const score4 = parseFloat(form.score4.value);\n    const averageScore = ((score1 + score2 + score3 + score4) / 4).toFixed(2);\n\n    const participant = {\n      id: id,\n      name: form.name.value,\n      email: form.email.value,\n      task: form.task.value,\n      averageScore: averageScore,\n      datetime: form.datetime.value,\n      scores: [score1, score2, score3, score4],\n    };\n\n    saveParticipant(participant);\n    modal.style.display = 'none';\n    form.reset();\n    tableBody.innerHTML = '';\n    loadParticipants();\n  };\n\n  const sortById = () => {\n    console.log('Sort by ID');\n    currentParticipants.sort((a, b) => a.id - b.id);\n    reloadTable(currentParticipants);\n  };\n\n  const sortByScore = () => {\n    console.log('Sort by score');\n    currentParticipants.sort((a, b) => b.averageScore - a.averageScore);\n    reloadTable(currentParticipants);\n  };\n\n  const sortByDate = () => {\n    console.log('Sort by date');\n    currentParticipants.sort(\n      (a, b) => new Date(a.datetime) - new Date(b.datetime)\n    );\n    reloadTable(currentParticipants);\n  };\n\n  const reloadTable = participants => {\n    console.log('Reload table with participants:', participants);\n    tableBody.innerHTML = '';\n    participants.forEach(participant => addRowToTable(participant));\n    updateButtonVisibility();\n  };\n\n  sortBtnId.addEventListener('click', sortById);\n  sortBtnScore.addEventListener('click', sortByScore);\n  sortBtnDate.addEventListener('click', sortByDate);\n\n  // Event handlers for tour buttons\n  tour1Btn.addEventListener('click', () => {\n    loadParticipants();\n  });\n\n  tour2Btn.addEventListener('click', () => {\n    const participants = JSON.parse(localStorage.getItem('participants')) || [];\n    currentParticipants = participants.filter(p => p.averageScore > 5);\n    localStorage.setItem(\n      'tour2Participants',\n      JSON.stringify(currentParticipants)\n    ); // Save filtered participants for tour2\n    reloadTable(currentParticipants);\n  });\n\n  tour3Btn.addEventListener('click', () => {\n    const participants =\n      JSON.parse(localStorage.getItem('tour2Participants')) || [];\n    currentParticipants = participants.filter(p => p.averageScore > 7);\n    localStorage.setItem(\n      'tour3Participants',\n      JSON.stringify(currentParticipants)\n    ); // Save filtered participants for tour3\n    reloadTable(currentParticipants);\n  });\n\n  loadParticipants();\n  updateButtonVisibility(); // Ensure button visibility is updated on page load\n});\n"],"names":["isAuthenticated","currentParticipants","logoutBtn","loginLink","updateButtonVisibility","button","modal","btn","span","form","tableBody","sortBtnId","sortBtnScore","sortBtnDate","tour1Btn","tour2Btn","tour3Btn","editMode","event","loadParticipants","participants","reloadTable","addRowToTable","participant","row","openEditModal","deleteParticipant","getNextId","saveParticipant","p","id","scores","score1","score2","score3","score4","averageScore","sortById","a","b","sortByScore","sortByDate"],"mappings":"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"}